<!--?xml version="1.0" encoding="utf-8"?--><!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head> 
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
  <meta http-equiv="Cache-control" content="no-cache" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" /> 
  <meta name="format-detection" content="telephone=no" /> 
  <meta name="keywords" content="EV3教育版解魔方机器人软件研究" /> 
  <meta name="description" content=" EV3教育版解魔方机器人软件研究 ,中文乐高" /> 
  <title>EV3教育版解魔方机器人软件研究 - 软件精华 -  中文乐高 -  手机版 - Powered by Discuz!</title> 
  <link rel="stylesheet" href="static/image/mobile/style.css" type="text/css" media="all" /> 
  <script src="static/js/mobile/jquery-1.8.3.min.js?jFt" type="text/javascript"></script> 
  <script type="text/javascript">var STYLEID = '1', STATICURL = 'static/', IMGDIR = 'static/image/common', VERHASH = 'jFt', charset = 'gbk', discuz_uid = '0', cookiepre = 'rYN0_2e9f_', cookiedomain = '.cmnxt.com', cookiepath = '/', showusercard = '1', attackevasive = '0', disallowfloat = 'newthread', creditnotice = '1|激情|,2|乐币|,3|宣传|,4|人气|,5|诚信|,7|威望|,8|学问|', defaultstyle = '', REPORTURL = 'aHR0cDovL3d3dy5jbW54dC5jb20vZm9ydW0ucGhwP21vZD12aWV3dGhyZWFkJnRpZD0xOTUzOCZtb2JpbGU9Mg==', SITEURL = 'http://www.cmnxt.com/', JSPATH = 'data/cache/';</script> 
  <script src="static/js/mobile/common.js?jFt" type="text/javascript" charset="gbk"></script> 
 </head> 
 <body class="bg"> 
  <!-- header start --> 
  <header class="header"> 
   <div class="nav"> 
    <span class="y"> <button class="btn_pn btn_pn_blue" id="replyid"><span>回复</span></button> </span> 
    <a href="forum.php?mod=forumdisplay&amp;fid=136&amp;&amp;mobile=2" class="z"><img src="static/image/mobile/images/icon_back.png" /></a> 
    <span class="name">软件精华</span> 
   </div> 
  </header> 
  <!-- header end --> 
  <!-- main postlist start --> 
  <div class="postlist"> 
   <h2> EV3教育版解魔方机器人软件研究 <a href="forum.php?mod=viewthread&amp;tid=19538&amp;page=1&amp;authorid=41378&amp;mobile=2" rel="nofollow" class="blue" style="font-size:12px;font-weight:normal;margin-left:10px;">只看楼主</a> </h2> 
   <div class="plc cl" id="pid252291"> 
    <span class="avatar"><img src="http://bbs.cmnxt.com/uc_server/avatar.php?uid=41378&amp;size=small" style="width:32px;height:32px;" /></span> 
    <div class="display pi" href="#replybtn_252291"> 
     <ul class="authi"> 
      <li class="grey"> <em> 1楼</em><b> <a href="home.php?mod=space&amp;uid=41378&amp;mobile=2" class="blue">hmq011212</a></b> </li> 
      <li class="grey rela"> <em><a href="home.php?mod=spacecp&amp;ac=favorite&amp;type=thread&amp;id=19538&amp;mobile=2" class="favbtn blue">收藏</a></em> 2016-5-29 17:04:20</li> 
     </ul> 
     <div class="message"> 
      <i class="pstatus"> 本帖最后由 hmq011212 于 2017-1-15 21:14 编辑 </i>
      <br /> 
      <br /> 
      <a href="forum.php?mod=viewthread&amp;tid=19538&amp;aid=41921&amp;from=album&amp;page=1&amp;mobile=2" class="orange"><img id="aimg_41921" src="forum.php?mod=image&amp;aid=41921&amp;size=140x140&amp;key=951ca2583d4f2def&amp;type=fixnone" alt="下载地址见图片" title="下载地址见图片" /></a> 
      <br /> 本文下载地址请下载上图，并按指引操作！
      <br /> 需要下载指引，请选中下面的内容，即可看到下载指引：
      <br /> 
      <font color="white">由于个人习惯，同时也为了防止百度抽风删除、限速等问题，已弃用百度网盘，改用Mega网盘，若遇到下载缓慢等情况，请自行科学上网后再下载！<br /> 指引：<br /> 1.将浏览器代理设置为“使用自动配置脚本”，并写入以下路径：“http://pac.itzmx.com/abc.pac”；<br /> 2.测试访问Google等网站，如需验证，请填入用户名：“root”，密码：“pac.itzmx.com”；<br /> 3.自行选择梯子（由于百度的原因，屏蔽VPNGATE），实际上还是能用的，请自己登陆</font>
      <font color="white">http://www.vpngate.net/</font>
      <font color="white"><font color="white">找到镜像站，下载VPNGATE；<br /> 4.安装VPNGATE，选择能用的VPN（需自行测试），点击连接；<br /> 5.若出现“协议错误，目标服务器返回错误”，则该服务器已被墙，请自行测试其他VPN；<br /> 6.取消代理设置，下载MEGADownload，选择加号，点击&quot;Retrieve Links from an image&quot;，浏览到下载到的图片，点击Load载入地址开始下载。<br /> -----------------------------------------------------------------------<br /> Notice: MEGA网盘很安全，不会删除用户分享的链接，所有数据都经加密，不存在泄露风险，请放心使用。<br /> 下载链接：见附件图片<br /> （链接持续更新，同时帖子也将同步更新，若更新不同步，请催促一下！）<br /> &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; hmq011212<br /> &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;2017/01/15 21点13分</font><br /> </font>
      <font color="#ff0000">原帖也将继续同步更新。</font>
      <br /> 
      <font size="6"><font color="red"><strong><font face="黑体">一月十五日更新，发上源文件，方便各位研究。同时计划将这个帖子分为两三部分，避免过长。</font></strong></font></font>
      <br /> 
      <font size="6"><font color="red"><strong><br /> </strong></font></font>
      <font size="6"><font color="red"><strong>十一月六日更新，完整的第二章。</strong></font></font>
      <br /> 
      <strong><font size="3">说明：由于某些原因，今后更贴会更慢，时间太有限了。我会更完的。</font></strong>
      <br /> 
      <br /> 
      <strong><font size="5"><font color="#ff0000">论</font></font></strong>
      <strong><font size="5"><font color="#ff0000">坛里人不多，只能设置回帖奖励了，凡是回帖者，有10%的几率获得2乐币。</font></font></strong>
      <br /> MindCub3r对于很多玩家来说已经十分熟悉了，当然作为一个
      <a href="http://bbs.cmnxt.com/forum-29-1.html" target="_blank" class="relatedlink">新手</a>，也是从搭建错误到不能扫描到成功解魔方过来的，MindCub3r的程序，是一个非常好的研究范本，它不仅仅运用了机械部分的操作，还运用了程序间的通信等高级内容。但是由于采用了Lego方面的编程系统，虽然是开放源代码，但是程序复杂后，就是一个大坑。相信没有人愿意看到这样的程序： 
      <a href="forum.php?mod=viewthread&amp;tid=19538&amp;aid=37592&amp;from=album&amp;page=1&amp;mobile=2" class="orange"><img id="aimg_37592" src="forum.php?mod=image&amp;aid=37592&amp;size=140x140&amp;key=d427f97bec42a50c&amp;type=fixnone" alt="程序.PNG" title="程序.PNG" /></a> 
      <br /> 这也已经是高度模块化的程序了。许多人该打退堂鼓了。
      <br /> 
      <br /> 作为一个学生，我当然也希望研究一下，于是就催生出了这篇文章。当然毕竟时间有限，我也不可能一天24小时扑在程序上，只有周末才能来研究一下，不可能每天都来更新帖子、给大家回复，所以大致会每周更新一次，统一回复三次。文章会分为几个章节（具体几个章节没想好），每个章节难度不同。当然由于我LDD技术有限，只能使用官方的搭建图，如果哪位能够提供教育版LDD图纸，那就更好了。我们开始看程序：
      <br /> 
      <br /> 
      <br /> 
      <br /> 
      <div align="center">
       <font face="宋体"><font style="font-size:16pt">第一章</font></font>
       <font style="font-size:16pt">&nbsp;&nbsp;</font>
       <font face="宋体"><font style="font-size:16pt">机械部分的初始化</font></font>
      </div>
      <div align="left">
       <strong><font color="red"><font face="黑体"><font style="font-size:14pt">有志者，事竟成。</font></font></font></strong>
      </div>
      <div align="right">
       <strong><font color="red"><font face="黑体"><font style="font-size:14pt">――引子</font></font></font></strong>
      </div>
      <div align="left">
       <font face="宋体">一、程序体：</font>
      </div>
      <div align="left">
       （一）、主程序：
      </div>
      <div align="left">
       1.&nbsp; &nbsp;&nbsp;&nbsp;闪烁红色指示灯；
      </div>
      <div align="left">
       2.&nbsp; &nbsp;&nbsp;&nbsp;调用Banner子程序，显示Banner；
      </div>
      <div align="left">
       3.&nbsp; &nbsp;&nbsp;&nbsp;调用Message子程序，显示信息（参数：Reset scan）；
      </div>
      <div align="left">
       4.&nbsp; &nbsp;&nbsp;&nbsp;调用ScanCal子程序，使扫描臂复位；
      </div>
      <div align="left">
       5.&nbsp; &nbsp;&nbsp;&nbsp;调用Message子程序，显示信息（参数：Reset tilt）；
      </div>
      <div align="left">
       6.&nbsp; &nbsp;&nbsp;&nbsp;调用TiltCal子程序，使翻动臂复位；
      </div>
      <div align="left">
       7.&nbsp; &nbsp;&nbsp;&nbsp;终止程序。
      </div>
      <div align="left">
       （二）、循环体：
      </div>
      <div align="left">
       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;1.LpMindCub3r（Mindcuber的循环体）
      </div>
      <div align="left">
       ①&nbsp;&nbsp;测量反射光线强度（端口2，光线传感器）；
      </div>
      <div align="left">
       ②&nbsp;&nbsp;调用CubeAbsent子程序，检测是否放置魔方；
      </div>
      <div align="left">
       ③&nbsp;&nbsp;测量环境光线强度（端口2，光线传感器）；
      </div>
      <div align="left">
       ④&nbsp;&nbsp;琥珀色指示灯常亮；
      </div>
      <div align="left">
       ⑤&nbsp;&nbsp;调用CubePresent子程序，检测现有魔方状态；
      </div>
      <div align="left">
       ⑥&nbsp;&nbsp;判断布尔型变量solve是否为真，为真，则执行ScanAndSolve子程序，为假，则执行Scramble子程序；
      </div>
      <div align="left">
       ⑦&nbsp;&nbsp;无限循环下去。
      </div>
      <div align="left">
       2. LpScanCal0（复位扫描臂）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;C电机旋转0.2s，并测量度数，传入变量a；
      </div>
      <div align="left">
       ②&nbsp; &nbsp;测量度数，传入变量b；
      </div>
      <div align="left">
       ③&nbsp; &nbsp;当a大于等于b时，返回真，否则返回假；
      </div>
      <div align="left">
       ④&nbsp; &nbsp;执行循环，直至返回值为真。
      </div>
      <div align="left">
       <i>注：此处事实上使电机旋转到“定位点”，方法是不断判断电机是否停止运动，若停止运动，则说明已经到达“定位点”。如下图：</i>
      </div>
      <div align="left">
       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; 
       <div align="center"> 
        <a href="forum.php?mod=viewthread&amp;tid=19538&amp;aid=37593&amp;from=album&amp;page=1&amp;mobile=2" class="orange"><img id="aimg_37593" src="forum.php?mod=image&amp;aid=37593&amp;size=140x140&amp;key=0bd6ac6bd6c7f681&amp;type=fixnone" alt="定位点.PNG" title="定位点.PNG" /></a> 
       </div>
       <br /> 
      </div>
      <div align="center">
       <i>扫描臂定位点</i>
      </div>
      <div align="left">
       2. LpScanCal1（复位扫描臂）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;C电机旋转0.2s，并测量度数，传入变量a；
      </div>
      <div align="left">
       ②&nbsp; &nbsp;测量度数，传入变量b；
      </div>
      <div align="left">
       ③&nbsp; &nbsp;当a大于等于b时，返回真，否则返回假；
      </div>
      <div align="left">
       ④&nbsp; &nbsp;执行循环，直至返回值为真。
      </div>
      <div align="left">
       &nbsp; &nbsp;&nbsp;&nbsp;
       <br /> 
       <i>注：此处事实上使电机旋转到“定位点” ，方法是不断判断电机是否停止运动，若停止运动，则说明已经到达“定位点”。如下图：</i>
      </div>
      <div align="center"></div>
      <div align="center">
       扫描臂定位点
      </div>
      <div align="left">
       &nbsp; &nbsp; 3.&nbsp; &nbsp;&nbsp;&nbsp;LpTiltCal（复位翻动臂）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;A电机旋转0.2s，并测量度数，传入变量a；
      </div>
      <div align="left">
       ②&nbsp; &nbsp;测量度数，传入变量b；
      </div>
      <div align="left">
       ③&nbsp; &nbsp;当a小于等于b时，返回真，否则返回假；
      </div>
      <div align="left">
       ④&nbsp; &nbsp;执行循环，直至返回值为真。
      </div>
      <div align="left">
       <i>注：此处事实上使电机旋转到“定位点” ，方法是不断判断电机是否停止运动，若停止运动，则说明已经到达“定位点”。如下图标黄色的部分，复位完成后，应当在七孔梁的同侧。</i>
      </div>
      <div align="center"> 
       <a href="forum.php?mod=viewthread&amp;tid=19538&amp;aid=37594&amp;from=album&amp;page=1&amp;mobile=2" class="orange"><img id="aimg_37594" src="forum.php?mod=image&amp;aid=37594&amp;size=140x140&amp;key=f8dae02497aea8d0&amp;type=fixnone" alt="定位点2.PNG" title="定位点2.PNG" /></a> 
      </div>
      <div align="center">
       <i>翻动臂定位点</i>
      </div>
      <br /> 
      <div align="left">
       （三）、子程序：
      </div>
      <div align="left">
       1.&nbsp; &nbsp;&nbsp; &nbsp;Banner（横幅）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;清屏，用网格状大字在屏幕左上角显示文本“MindCub3r”；
      </div>
      <div align="left">
       ②&nbsp; &nbsp;在文本“MindCub3r”右上方用像素小字显示文本“v1p9”；
      </div>
      <div align="left">
       ③&nbsp; &nbsp;调用BannerVariant子程序，在文本“v1p9”下方用像素小字显示文本“Edu”；
      </div>
      <div align="left">
       ④&nbsp; &nbsp;在该行字符下，绘制填充的矩形，长141px，宽3px；
      </div>
      <div align="left">
       ⑤&nbsp; &nbsp;在矩形左下，用像素小字显示文本“By David Gilday”；
      </div>
      <div align="left">
       ⑥&nbsp; &nbsp;在文本“By David Gilday”左下，用像素小字显示文本“mindcuber.com”；
      </div>
      <div align="left">
       ⑦&nbsp; &nbsp;返回主程序。
      </div>
      <div align="left">
       2.&nbsp; &nbsp;&nbsp; &nbsp;Message【信息（状态？）】
      </div>
      <div align="left">
       ①&nbsp;&nbsp;合并文本，参数A指定为调用子程序时所用的参数；
      </div>
      <div align="left">
       ②&nbsp;&nbsp;在文本“mindcuber.com”下，将合并后的结果用网格状大字显示；
      </div>
      <div align="left">
       ③&nbsp;&nbsp;返回主程序；
      </div>
      <div align="left">
       3.&nbsp; &nbsp;&nbsp; &nbsp;ScanCal（扫描臂计算）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;将C端口的电机功率设定为40%；
      </div>
      <div align="left">
       ②&nbsp; &nbsp;执行循环体LpScanCal0，复位电机；
      </div>
      <div align="left">
       ③&nbsp; &nbsp;C端口中型电机以40%功率倒转100&deg;，结束时制动；
      </div>
      <div align="left">
       ④&nbsp; &nbsp;将C端口的电机功率设定为20%；
      </div>
      <div align="left">
       ⑤&nbsp; &nbsp;执行循环体LpScanCal1，复位电机；
      </div>
      <div align="left">
       ⑥&nbsp; &nbsp;重置电机度数为0&deg;；
      </div>
      <div align="left">
       ⑦&nbsp; &nbsp;调用子程序ScanAway，使扫描臂返回工作位置；
      </div>
      <div align="left">
       ⑧&nbsp; &nbsp;返回主程序。
      </div>
      <div align="left">
       4.&nbsp; &nbsp;&nbsp; &nbsp;ScanAway（扫描臂返回工作位置）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;测量电机旋转度数，传入变量b；
      </div>
      <div align="left">
       注：由于在LpScanCal1循环体中，已经完成了电机度数的重置，且中途没有退出程序，故此时电机度数为0。
      </div>
      <div align="left">
       ②&nbsp; &nbsp;计算a-b的值，变量a为常数-340，并使电机以100%的功率转动(a-b)&deg;；
      </div>
      <div align="left">
       注：此时(a-b)的值为-340。
      </div>
      <div align="left">
       ③&nbsp; &nbsp;返回主程序。
      </div>
      <div align="left">
       5.&nbsp; &nbsp;&nbsp; &nbsp;TiltCal（翻动臂计算）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;将A端口的电机功率设定为-20%（倒转20%）；
      </div>
      <div align="left">
       ②&nbsp; &nbsp;执行子程序TiltOffset，声明变量bit_offest（偏移量）并赋值；
      </div>
      <div align="left">
       ③&nbsp; &nbsp;执行循环体LpTiltCal，复位翻动臂；
      </div>
      <div align="left">
       ④&nbsp; &nbsp;重置电机度数为0&deg;；
      </div>
      <div align="left">
       ⑤&nbsp; &nbsp;调用子程序TiltAway，使翻动臂返回工作位置；
      </div>
      <div align="left">
       ⑥&nbsp; &nbsp;返回主程序。
      </div>
      <div align="left">
       6.&nbsp; &nbsp;&nbsp; &nbsp;TiltAway（翻动臂返回工作位置）
      </div>
      <div align="left">
       ①&nbsp; &nbsp;测量电机旋转度数，传入变量a；
      </div>
      <div align="left">
       注：由于在LpTiltCal循环体中，已经完成了电机度数的重置，且中途没有退出程序，故此时电机度数为0。
      </div>
      <div align="left">
       ②&nbsp; &nbsp;计算a-b的值，变量b为常数10，并使电机以70%的功率转动(a-b)&deg;；
      </div>
      <div align="left">
       注：此时(a-b)的值为-10。
      </div>
      <div align="left">
       ③&nbsp; &nbsp;返回主程序。
      </div>
      <div align="right">
       2016年5月29日
      </div>
      <div align="right">
       山东省
      </div>
      <div align="left">
       （注：这一章是我早期完成的，只是改了改日期，实际完成日期为5月21日，若有不妥之处，敬请PM，文章将会持续更新。）
      </div>
      <br /> 
      <br /> 今天是6月4日，我们将要进行小中考，时间比较多，更新频率会大些。每次更新也会多些。有一点做阅卷机的想法，这篇文章完成后，将会写下阅卷机的文章，一样持续更新，这是后话。现在是下午17点25分。开始更新。
      <br /> 
      <div align="center">
       <font face="宋体"><font style="font-size:16pt">第二章&nbsp;&nbsp;隐秘的部分</font></font>
      </div>
      <div align="left">
       <strong><font color="red"><font face="黑体"><font style="font-size:14pt">重要提示：如果第一章都看不懂了，那么请不要继续看第二章!！！</font></font></font></strong>
      </div>
      <div align="right">
       <strong><font color="red"><font face="黑体"><font style="font-size:14pt">-</font></font></font></strong>
       <strong><font color="red"><font face="黑体"><font style="font-size:14pt">――引子</font></font></font></strong>
      </div>
      <div align="left">
       <font face="宋体"><font style="font-size:10.5pt">这仅仅是开个玩笑，这一部分难度增加了，但是也不是最难的一部分。这一部分你几乎看不见，但是后面还是会用到。所以，这一章还是比较重要的。</font></font>
      </div>
      <div align="left">
       <font face="宋体"><font style="font-size:10.5pt">首先，我们要引入一些概念，这也是我们第一章结束的原因。这些概念，我都会用最最通俗的语言来叙述。</font></font>
      </div>
      <div align="left">
       1. 变量：所谓变量，其实就是“可变的量”，你可以把它想象成一个缸，在这个缸里面放上水，它就叫“水缸”，在这个缸里面放上米，它就叫“米缸”，这个“缸”里放上什么，它里面就有什么，缸里的物质是可以改变的。在编程中，常用来存储可变的量，在程序执行过程中，变量的量是可变的，它存储于内存中。在C++中常用的定义变量的方式为“数据类型 变量名”；
      </div>
      <div align="left">
       2. 数组（排列）：数组也叫排列。所谓数组，其实就是一个变量，只不过这个变量中含有多个元素，怎么理解呢？变量是个缸，缸里放上米，这个缸里每一粒米都是这个缸的“元素”，这个缸就是一个数组，它也存储在内存里。在C++中常用的定义数组的方式为“数据类型 数组名[数组宽度]”，这个“数组宽度”，就是数组的大小；
      </div>
      <div align="left">
       3. 数据类型：所谓数据类型，实际上就是指这个数据是什么一类东西，比如“abc”是字符型(char)数据[又称“文本型（text）数据”]；比如“123”是整数型(int)数据；比如“123.456”是单精度小数型(float)数据；比如“3.1415926535”是双精度小数型(double)数据，以上整数型、单双精度小数型数据，在EV3的编程系统中，统称为“数字型数据”。当然，有一个特例，布尔型(bool)数据，只有“真”与“假”两种状态，被称为“逻辑型数据”。在EV3编程系统中，可用的只有这几种数据类型。
      </div>
      <div align="left">
       4. 函数：函数不同于数学中的函数，它是由一组命令组成的，你也可以把它视作“模块”，一个模块完成一项任务，函数组合在一起，就是一个程序，在EV3编程系统中，被称为“模块”。
      </div>
      <div align="left">
       5. 参数：参数与函数有关，就是函数执行时所需要的数据。
      </div>
      <div align="left">
       <font face="宋体"><font style="font-size:10.5pt">好了，概念介绍完毕，进入正题前，我还要嗦几句：由于EV3的编程系统模块化、图形化程度太高，阅读程序十分不便，我在下面的叙述中可能会用到一些C语言的代码，如果不能理解，请再次阅读一下上面的叙述。</font></font>
      </div>
      <div align="left">
       <font face="宋体"><font style="font-size:10.5pt">附:</font></font>
      </div>
      <div align="left">
       <table>
        <tbody>
         <tr>
          <td>&nbsp; &nbsp;
           <div align="center">
            <font face="宋体"><font style="font-size:10.5pt">C</font></font>
            <font face="宋体"><font style="font-size:10.5pt">语言代码</font></font>
           </div>&nbsp;&nbsp;</td>
          <td>
           <div align="left">
            <div align="center">
             <font face="宋体"><font style="font-size:10.5pt">自然语言</font></font>
            </div>
           </div></td>
         </tr>
         <tr>
          <td>
           <div align="left">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">int&nbsp;&nbsp;</font></font>
             <font face="宋体"><font style="font-size:10.5pt">变量名=某个值</font></font>
            </div>
           </div></td>
          <td>
           <div align="right">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">定义一个数字型变量，名为<i>变量名</i>，并赋值为<i>某个值</i>。</font></font>
            </div>
           </div></td>
         </tr>
         <tr>
          <td>
           <div align="left">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">char&nbsp;&nbsp;</font></font>
             <font face="宋体"><font style="font-size:10.5pt">变量名=某个值</font></font>
            </div>
           </div></td>
          <td>
           <div align="right">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">定义一个数字型变量，名为<i>变量名</i>，并赋值为<i>某个值</i>。</font></font>
            </div>
           </div></td>
         </tr>
         <tr>
          <td>
           <div align="left">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">bool&nbsp;&nbsp;</font></font>
             <font face="宋体"><font style="font-size:10.5pt">变量名=T/F</font></font>
            </div>
           </div></td>
          <td>
           <div align="right">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">定义一个逻辑型变量，名为<i>变量名，</i>并赋值为<strong><i>真/伪</i></strong>（注意：只有这两种值!）</font></font>
            </div>
           </div></td>
         </tr>
         <tr>
          <td>
           <div align="left">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">int&nbsp;&nbsp;</font></font>
             <font face="宋体"><font style="font-size:10.5pt">数组名[]={元素1,元素2,…，元素n}</font></font>
            </div>
           </div></td>
          <td>
           <div align="right">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">定义一个数字型排列，名为<i>数组名</i>，并提供<i>元素1</i>、<i>元素2</i>、……<i>元素n</i>。</font></font>
            </div>
           </div></td>
         </tr>
         <tr>
          <td>
           <div align="left">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">bool&nbsp;&nbsp;</font></font>
             <font face="宋体"><font style="font-size:10.5pt">数组名[]={元素1,元素2,…,元素n }</font></font>
            </div>
           </div></td>
          <td>
           <div align="right">
            <div align="left">
             <font face="宋体"><font style="font-size:10.5pt">定义一个逻辑型排列，名为<i>数组名</i>，并提供<i>元素1</i>、<i>元素2</i>、……<i>元素n</i>。</font></font>
            </div>
           </div></td>
         </tr>
        </tbody>
       </table>
      </div>
      <table>
       <tbody>
        <tr>
         <td></td>
        </tr>
        <tr>
         <td></td>
        </tr>
       </tbody>
      </table>
      <div align="left">
       一、函数
      </div>
      <div align="left">
       1. InitTables函数
      </div>
      <div align="left">
       //无返回值
      </div>
      <div align="left">
       void InitTables()
      </div>
      <div align="left">
       {
      </div>
      <div align="left">
       int dbg=0;
      </div>
      <div align="left">
       int imap[]={-1,0,-1,6,12,18,24,-1,30,-1,36,42,-1,48,-1,54,60,66,72,-1,78,-1,84,90,96,102,108,114,-1,-1,120,126,132,-1,-1};
      </div>
      <div align="left">
       //写这行代码用了我三分钟，可见EV3的编程环境非常糟糕。
      </div>
      <div align="left">
       intfmap[]={0,1,2,3,4,5,0,3,2,1,5,4,2,4,5,3,1,0,5,2,4,1,3,1,0,3,2,5,4,1,2,3,0,
      </div>
      <div align="left">
       4,5,1,4,3,5,0,2,1,5,3,4,2,0,2,1,0,3,5,4,2,3,0,1,4,5,2,4,0,5,1,3,2,5,0,4,3,1,3,0,1,2,4,5,3,2,1,0,5,4,3,4,1,5,2,0,3,5,1,4,0,2,4,0,5,2,1,3,4,1,5,3,2,0,4,2,5,0,3,1,4,3,5,1,0,2,5,0,4,2,3,1,5,1,4,3,0,2,5,2,4,0,1,3,5,3,4,1,2,0};
      </div>
      <div align="left">
       intedge0_tab[]={1,7,5,3,43,31,23,35,21,11,19,17};
      </div>
      <div align="left">
       intedge1_tab[]={29,41,9,33,15,47,45,27,25,39,37,13};
      </div>
      <div align="left">
       intcorner0_tab[]={2,0,6,4,16,22,20,18};
      </div>
      <div align="left">
       intcorner1_tab[]={28,40,8,32,44,24,36,12};
      </div>
      <div align="left">
       intcorner2_tab[]={34,30,42,10,14,46,26,38};
      </div>
      <div align="left">
       int index_index[]={0,0,0};
      </div>
      <div align="left">
       intcube[]={0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,
      </div>
      <div align="left">
       4,4,4,4,4,4,4,5,5,5,5,5,5,5,5};
      </div>
      <div align="left">
       intscan_red[]={0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,
      </div>
      <div align="left">
       3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5};
      </div>
      <div align="left">
       intscan_green[]={0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,
      </div>
      <div align="left">
       3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5};
      </div>
      <div align="left">
       intscan_blue[]={0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,
      </div>
      <div align="left">
       3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5};
      </div>
      <div align="left">
       int mv_faces[]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
      </div>
      <div align="left">
       0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
      </div>
      <div align="left">
       intmv_turns[]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
      </div>
      <div align="left">
       0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
      </div>
      <div align="left">
       intmv_cut[]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
      </div>
      <div align="left">
       0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
      </div>
      <div align="left">
       int turntable_position=0;
      </div>
      <div align="left">
       int turntable_offset=24;
      </div>
      <div align="left">
       //崩溃！我不得不休息一下。这么多数字……
      </div>
      <div align="left">
       (未完成)
      </div>
      <div align="left">
       }
      </div>
      <div align="right">
       5.22
      </div>
      <div align="left">
       （以上内容我自己都头大，重写！）
      </div>
      <div align="right">
       5.29
      </div>
      <div align="left">
       一、函数
      </div>
      <div align="left">
       1.&nbsp;&nbsp;InitTables函数（变量表）
      </div>
      <div align="left">
       ① 定义变量dbg，并赋值为0；
      </div>
      <div align="left">
       ② 定义数组imap，并插入元素{0,1,2,3,4,5,0,3,2,1,5,4,2,4,5,3,1,0,5,2,4,1,3,1,0,3,2,5,4,1,2,3,0,4,5,1,4,3,5,0,2,1,5,3,4,2,0,2,1,0,3,5,4,2,3,0,1,4,5,2,4,0,5,1,3,2,5,0,4,3,1,3,0,1,2,4,5,3,2,1,0,5,4,3,4,1,5,2,0,3,5,1,4,0,2,4,0,5,2,1,3,4,1,5,3,2,0,4,2,5,0,3,1,4,3,5,1,0,2,5,0,4,2,3,1,5,1,4,3,0,2,5,2,4,0,1,3,5,3,4,1,2,0}；
      </div>
      <div align="left">
       ③ 定义数组edge0_tab并插入元素{1,7,5,3,43,31,23,35,21,11,19,17}；
      </div>
      <div align="left">
       ④ 定义数组……并插入元素……（我不写了，有需要的自己翻阅上述内容，总之就是定义变量）；
      </div>
      <div align="left">
       ⑤ 调用Message函数，显示文本“Find solver”。
      </div>
      <div align="left">
       ⑥ 调用SolverCommand函数，参数cmd=2 [有些类似EV3Messager的做法，若想了解详情，请访问
       <a href="http://bbs.cmnxt.com/thread-12655-1-1.html" target="_blank">http://bbs.cmnxt.com/thread-12655-1-1.html</a>与http://ev3messenger.codeplex.com/（需楼梯）]；
      </div>
      <div align="left">
       ⑦ 执行循环LpInitTables，判断Solver是否响应（
       <strong>此处就是卡在Findsolver的循环</strong>）；
      </div>
      <div align="left">
       ⑧ 播放音调（1000Hz，0.1s，音量100%，播放一次）；
      </div>
      <div align="left">
       ⑨ 定义数字型变量pattern，并赋值为0；
      </div>
      <div align="left">
       ⑩ 定义数字型变量pattern_mode，并赋值为0；
      </div>
      <div align="left">
       76&nbsp;&nbsp;调用GetPattern函数，返回name, faces, turns, number；
      </div>
      <div align="left">
       77&nbsp;&nbsp;调用SetPattern函数，参数faces, turns均使用GetPattern中的返回值；
      </div>
      <div align="left">
       78&nbsp;&nbsp;调用CubeDetect函数，检测魔方；
      </div>
      <div align="left">
       79&nbsp;&nbsp;返回主程序。
      </div>
      <div align="left">
       2.&nbsp;&nbsp;△SolverCommand函数（给Solver发信息）
      </div>
      <div align="left">
       ① 删除mc3cmd文件；
      </div>
      <div align="left">
       ② 创建mc3cmd文件，并写入cmd；
      </div>
      <div align="left">
       ③ 关闭mc3cmd文件，返回主程序。
      </div>
      <div align="left">
       <font size="2">3.&nbsp;&nbsp;△SolverResponse函数（检测Solver是否响应）</font>
      </div>
      <div align="left">
       <font size="2">①&nbsp;&nbsp;读取mc3cmd文件，并将其值返回为resp，Mod2后判断是否与1相等，若相等返回done为真，否则返回done为假；</font>
      </div>
      <div align="left">
       <font size="2">②&nbsp;&nbsp;关闭mc3cmd文件。</font>
      </div>
      <div align="left">
       <font size="2">4.&nbsp;&nbsp;GetPattern函数（取解魔方模式函数）</font>
      </div>
      <div align="left">
       <font size="2">①&nbsp;&nbsp;判断传入的number值：</font>
      </div>
      <div align="left">
       <font size="2">⑴ 若为0，则返回name为Solve； </font>
      </div>
      <div align="left">
       <font size="2">⑵ 若为1，则返回name为CheckerBoard（棋盘形），定义数组checkboard_faces，并添加元素{0,2,1,3,4,5}，定义数组checkboard_turns，并添加元素{2,2,2,2,2,2}；</font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(3) </font></font><font face="宋体"><font style="font-size:10.5pt">若为2，则返回name为Cube-in-cube（魔方套魔方），定义数组cubes_faces，并添加元素{0,4,2,1,4,0,4,0,4,0,4,5,2,5,1,2,4}，定义数组cubes_turns，并添加元素{-1,1,-1,-1,1,2,2,-1,-1,1,2,1,-1,-1,2,2,-1}，返回faces为cubes_faces，返回turns为cubes_turns；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(4) </font></font><font face="宋体"><font style="font-size:10.5pt">若为3，则返回name为Six-spot（蓝点），定义数组spot_faces，并添加元素{4,5,1,3,0,2,4,5}，定义数组spot_turns，并添加元素{1,-1,1,-1,1,-1,1,-1}，返回faces为spot_faces，返回turns为spot_turns；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(5) </font></font><font face="宋体"><font style="font-size:10.5pt">若为4，则返回name为snake（S形），定义数组snake_faces，并添加元素{1,5,0,5,3,0,3,5,0,5,1,5,0,1}，定义数组snake_turns，并添加元素{-1,-1,1,1,2,1,2,1,-1,1,-1,2,-1,2}，返回faces为snake_faces，返回turns为snake_turns；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(6) </font></font><font face="宋体"><font style="font-size:10.5pt">若为5，则返回name为Superflip（翻棱），定义数组superflip_faces，并添加元素{0,1,4,0,4,2,1,3,0,1,4,5,1,2,3,4,1,2,1,2}，定义数组superflip_turns，并添加元素{-1,2,-1,2,2,2,1,-1,-1,2,1,1,-1,2,-1,2,-1,2,-1,-1}，返回faces为superflip_faces，返回turns为superflip_turns；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(6) </font></font><font face="宋体"><font style="font-size:10.5pt">若为-1，则返回name为All（所有），返回faces为空数组，返回turns为空数组；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(7) </font></font><font face="宋体"><font style="font-size:10.5pt">若为-2，则返回name为Random（随机），返回faces为空数组，返回turns为空数组；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">(8) </font></font><font face="宋体"><font style="font-size:10.5pt">若为-3，则返回name为Scramble（打乱），返回faces为空数组，返回turns为空数组；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">②&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">返回number为5；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">③&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">返回InitTables函数。</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="仿宋"><font style="font-size:9pt">(</font></font><font face="仿宋"><font style="font-size:9pt">注：初始状态为-1，即All。吐槽：本来是一个switch语句，结果搞得这么复杂，我想念写两个函数直接return faces，然后再return turns的时代，还有乐高公司麻烦出个全局变/常量和局部变/常量吧，看“*量表”眼花啊，顺便把变量值加进去……</font></font></font>
      </div>
      <div align="left">
       <font face="仿宋"><font style="font-size:9pt"><font color="#000000">还有所谓“结构化编程”对于ev3来说就是个笑话，你这是图形化编程，易学倒是易学，对开发大工程来说就是噩梦……)</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">5.&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">SetPatten</font></font><font face="宋体"><font style="font-size:10.5pt">函数（设置魔方模式函数）</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">①&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">删除文件mc3dat；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">②&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">取数组faces的长度，判断是否介于1-100之间；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑴&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">若介于1-100之间，则向mc3dat中写入数组faces的长度，执行LpSetPattern0循环，继续顺次写入faces、turns数组的各个值；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑵&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">若不介于1-100之间，则向mc3dat中写入0；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">③&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">关闭mc3dat文件；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">④&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">执行SolverCommand函数，参数cmd=8；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑤&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">执行LpSetPattern循环，判断解魔方程序是否响应；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑴&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">等待0.1秒；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑵&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">执行SolverResponse函数，检测是否响应；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑶&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">若响应，返回InitTables程序；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">⑷&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">若无响应，继续执行循环。</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">6.&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">CubeDetect</font></font><font face="宋体"><font style="font-size:10.5pt">函数（检测魔方函数）</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">①&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">调用1号端口的超声波传感器测量距离；</font></font></font>
      </div>
      <div align="left">
       <font color="#000000"><font face="宋体"><font style="font-size:10.5pt">②&nbsp;&nbsp;</font></font><font face="宋体"><font style="font-size:10.5pt">判断6-10厘米处是否有物体，若有物体返回真，否则返回假。</font></font></font>
      </div> 
     </div> 
    </div> 
   </div> 
   <div class="plc cl" id="pid252307"> 
    <span class="avatar"><img src="http://bbs.cmnxt.com/uc_server/avatar.php?uid=28550&amp;size=small" style="width:32px;height:32px;" /></span> 
    <div class="display pi" href="#replybtn_252307"> 
     <ul class="authi"> 
      <li class="grey"> <em> 2楼</em><b> <a href="home.php?mod=space&amp;uid=28550&amp;mobile=2" class="blue">非常乐</a></b> </li> 
      <li class="grey rela"> 2016-5-29 17:57:08</li> 
     </ul> 
     <div class="message">
       非常棒，期待其他章节 
     </div> 
    </div> 
   </div> 
   <div class="plc cl" id="pid252343"> 
    <span class="avatar"><img src="http://bbs.cmnxt.com/uc_server/avatar.php?uid=45246&amp;size=small" style="width:32px;height:32px;" /></span> 
    <div class="display pi" href="#replybtn_252343"> 
     <ul class="authi"> 
      <li class="grey"> <em> 3楼</em><b> <a href="home.php?mod=space&amp;uid=45246&amp;mobile=2" class="blue">流逝年华</a></b> </li> 
      <li class="grey rela"> 2016-5-29 20:06:20</li> 
     </ul> 
     <div class="message">
       学习 
     </div> 
    </div> 
   </div> 
   <div class="plc cl" id="pid252743"> 
    <span class="avatar"><img src="http://bbs.cmnxt.com/uc_server/avatar.php?uid=42326&amp;size=small" style="width:32px;height:32px;" /></span> 
    <div class="display pi" href="#replybtn_252743"> 
     <ul class="authi"> 
      <li class="grey"> <em> 4楼</em><b> <a href="home.php?mod=space&amp;uid=42326&amp;mobile=2" class="blue">天空小城</a></b> </li> 
      <li class="grey rela"> 2016-5-31 14:02:58</li> 
     </ul> 
     <div class="message">
       好贴，一直想学习，这会可以看到详细的解释了，期待更新。 
     </div> 
    </div> 
   </div> 
   <div class="plc cl" id="pid252818"> 
    <span class="avatar"><img src="http://bbs.cmnxt.com/uc_server/avatar.php?uid=45354&amp;size=small" style="width:32px;height:32px;" /></span> 
    <div class="display pi" href="#replybtn_252818"> 
     <ul class="authi"> 
      <li class="grey"> <em> 5楼</em><b> <a href="home.php?mod=space&amp;uid=45354&amp;mobile=2" class="blue">奶牛大哥</a></b> </li> 
      <li class="grey rela"> 2016-5-31 19:03:10</li> 
     </ul> 
     <div class="message">
       真是肯钻研，赞 
     </div> 
    </div> 
   </div> 
   <div id="post_new"></div> 
   <div class="plc cl"> 
    <form method="post" autocomplete="off" id="fastpostform" action="forum.php?mod=post&amp;action=reply&amp;fid=136&amp;tid=19538&amp;extra=&amp;replysubmit=yes&amp;mobile=2"> 
     <input type="hidden" name="formhash" value="09db36d1" /> 
     <span class="avatar"><img style="height:32px;width:32px;" src="http://bbs.cmnxt.com/uc_server/avatar.php?uid=0&amp;size=small" /></span> 
     <div class="pi"> 
      <ul class="fastpost"> 
       <li><input type="text" value="我也说一句" class="input grey" color="gray" name="message" id="fastpostmessage" /></li> 
       <li id="fastpostsubmitline" style="display:none;"><input type="button" value="回复" class="button2" name="replysubmit" id="fastpostsubmit" /><a href="forum.php?mod=post&amp;action=reply&amp;fid=136&amp;tid=19538&amp;reppost=252291&amp;page=1&amp;mobile=2" class="y" style="height:30px;width:30px;margin-top:7px;background:url(static/image/mobile/images/icon_photo.png) no-repeat"><span class="none">回复</span></a></li> 
      </ul> 
     </div> 
    </form> 
   </div> 
   <script type="text/javascript">
(function() {
var form = $('#fastpostform');
$('#fastpostmessage').on('focus', function() {
popup.open('您还未登录，立即登录?', 'confirm', 'member.php?mod=logging&action=login');
this.blur();
});
$('#fastpostsubmit').on('click', function() {
var msgobj = $('#fastpostmessage');
if(msgobj.val() == '我也说一句') {
msgobj.attr('value', '');
}
$.ajax({
type:'POST',
url:form.attr('action') + '&handlekey=fastpost&loc=1&inajax=1',
data:form.serialize(),
dataType:'xml'
})
.success(function(s) {
evalscript(s.lastChild.firstChild.nodeValue);
})
.error(function() {
window.location.href = obj.attr('href');
popup.close();
});
return false;
});

$('#replyid').on('click', function() {
$(document).scrollTop($(document).height());
$('#fastpostmessage')[0].focus();
});

})();

function succeedhandle_fastpost(locationhref, message, param) {
var pid = param['pid'];
var tid = param['tid'];
if(pid) {
$.ajax({
type:'POST',
url:'forum.php?mod=viewthread&tid=' + tid + '&viewpid=' + pid + '&mobile=2',
dataType:'xml'
})
.success(function(s) {
$('#post_new').append(s.lastChild.firstChild.nodeValue);
})
.error(function() {
window.location.href = 'forum.php?mod=viewthread&tid=' + tid;
popup.close();
});
} else {
if(!message) {
message = '本版回帖需要审核，您的帖子将在通过审核后显示';
}
popup.open(message, 'alert');
}
$('#fastpostmessage').attr('value', '');
if(param['sechash']) {
$('.seccodeimg').click();
}
}

function errorhandle_fastpost(message, param) {
popup.open(message, 'alert');
}
</script> 
  </div> 
  <!-- main postlist end --> 
  <div class="pg">
   <strong>1</strong>
   <a href="forum.php?mod=viewthread&amp;tid=19538&amp;extra=&amp;page=2&amp;mobile=2">2</a>
   <a href="forum.php?mod=viewthread&amp;tid=19538&amp;extra=&amp;page=3&amp;mobile=2">3</a>
   <a href="forum.php?mod=viewthread&amp;tid=19538&amp;extra=&amp;page=4&amp;mobile=2">4</a>
   <a href="forum.php?mod=viewthread&amp;tid=19538&amp;extra=&amp;page=10&amp;mobile=2" class="last">.. 10</a>
   <label><input type="text" name="custompage" class="px" size="2" title="输入页码，按回车快速跳转" value="1" onkeydown="if(event.keyCode==13) {window.location='forum.php?mod=viewthread&amp;tid=19538&amp;extra=&amp;page='+this.value;; doane(event);}" /><span title="共 10 页"> / 10 页</span></label>
   <a href="forum.php?mod=viewthread&amp;tid=19538&amp;extra=&amp;page=2&amp;mobile=2" class="nxt">下一页</a>
  </div> 
  <script type="text/javascript">
$('.favbtn').on('click', function() {
var obj = $(this);
$.ajax({
type:'POST',
url:obj.attr('href') + '&handlekey=favbtn&inajax=1',
data:{'favoritesubmit':'true', 'formhash':'09db36d1'},
dataType:'xml',
})
.success(function(s) {
popup.open(s.lastChild.firstChild.nodeValue);
evalscript(s.lastChild.firstChild.nodeValue);
})
.error(function() {
window.location.href = obj.attr('href');
popup.close();
});
return false;
});
</script> 
  <a href="javascript:;" title="返回顶部" class="scrolltop bottom"></a> 
  <div id="mask" style="display:none;"></div> 
  <div class="footer"> 
   <div> 
    <a href="forum.php?mobile=2">首页</a> | 
    <a href="member.php?mod=logging&amp;action=login&amp;mobile=2" title="登录">登录</a> | 
    <a href="javascript:;" style="color:#D7D7D7;" title="马上注册">注册</a> 
   </div> 
   <div> 
    <a href="http://www.cmnxt.com/forum.php?mod=viewthread&amp;tid=19538&amp;mobile=1&amp;simpletype=no">标准版</a> | 
    <a href="javascript:;" style="color:#D7D7D7;">触屏版</a> | 
    <a href="http://www.cmnxt.com/forum.php?mod=viewthread&amp;tid=19538&amp;mobile=no">电脑版</a> | 
   </div> 
   <p>&copy; Comsenz Inc.</p> 
  </div>  
 </body>
</html>